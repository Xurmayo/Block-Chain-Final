<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Open-Source Funding DApp</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />

  <script src="https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.umd.min.js"></script>
  <script src="https://unpkg.com/ethereum-blockies@0.1.1/blockies.min.js"></script>
</head>

<body>
  <header>
    <span class="brand">Open-Source Funding DApp</span>
    <div class="wallet-info">
      <span id="avatar"></span>
      <span id="wallet">Not connected</span>
      <span id="balance">0 ETH</span>
      <span id="tokenBalance">0 CTKN</span>
    </div>
  </header>

  <div class="container">
    <div id="login" class="card">
      <h3>Select Role</h3>
      <button type="button" data-role="creator">Creator</button>
      <button type="button" class="secondary" data-role="moderator">Moderator</button>
      <button type="button" class="secondary" data-role="contributor">Contributor</button>
    </div>

    <div id="creatorUI" class="card hidden">
      <h3>Creator Dashboard</h3>
      <label class="input-label" for="title">Title</label>
      <input id="title" type="text" placeholder="Campaign title" autocomplete="off" />
      <label class="input-label" for="description">Description</label>
      <textarea id="description"
        placeholder="Describe what the campaign is for, how funds will be used, and why backers should contribute."
        rows="4"></textarea>
      <label class="input-label" for="goal">Goal (ETH)</label>
      <input id="goal" type="text" placeholder="e.g. 1.5" inputmode="decimal" />
      <label class="input-label" for="duration">Duration (seconds)</label>
      <input id="duration" type="text" placeholder="e.g. 86400 (24 hours)" inputmode="numeric" />
      <button type="button" id="btnSubmitCampaign">Submit Campaign</button>
    </div>

    <div id="moderatorUI" class="card hidden">
      <h3>Moderator Dashboard</h3>
      <p style="margin:0;color:var(--text-muted);">Review submitted campaigns below and approve or reject them.</p>
    </div>

    <div id="contributorUI" class="card hidden">
      <h3>Contributor Dashboard</h3>
      <input id="contributeCampaignId" type="text" placeholder="Campaign ID (0-based)" inputmode="numeric" />
      <input id="contributeAmount" type="text" placeholder="ETH amount" inputmode="decimal" />
      <button type="button" id="btnContribute">Contribute</button>
      <button type="button" class="secondary" id="btnRefund">Refund (failed campaign)</button>
    </div>

    <div id="nftSection" class="card hidden">
      <h3>NFT Badge</h3>
      <button type="button" id="btnTradeNFT">Trade 10 CTKN for NFT Badge</button>
      <div id="nftChoicesModal" class="nft-modal hidden">
        <span class="nft-choices-label">Choose your NFT badge:</span>
        <div id="nftChoices" class="nft-choices"></div>
        <button type="button" class="secondary" id="confirmNFTBtn" disabled>Confirm Trade</button>
        <button type="button" class="secondary" id="btnHideNFTModal">Cancel</button>
      </div>
      <div id="nftList" class="nft-list"></div>
      <button type="button" class="secondary hidden" id="setNFTBtn">Set NFT as Avatar</button>
    </div>

    <h2 class="section-title">Live Campaigns</h2>
    <div id="campaigns" class="grid"></div>
  </div>

  <div id="contributorCounter" class="contributor-counter hidden" title="Click to view all-time contributors">
    <span id="contributorCountValue">0</span>
    <span class="contributor-counter-label">Contributors</span>
  </div>

  <script src="app.js"></script>
</body>

</html>